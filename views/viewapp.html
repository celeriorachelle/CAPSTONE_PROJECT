<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Appointments | Everlasting Peace Memorial Park</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #fdf5ee 0%, #f5ede4 100%);
      min-height: 100vh;
      color: #333;
    }

    /* Admin Header */
    .admin-header {
      background: linear-gradient(135deg, #2d4a24 0%, #1a2f16 100%);
      color: white;
      padding: 1rem 2rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .admin-header h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .admin-header h1::before {
      content: 'üèõÔ∏è';
      font-size: 1.5rem;
    }

    .admin-header nav ul {
      list-style: none;
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .admin-header nav ul li a {
      color: rgba(255,255,255,0.9);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .admin-header nav ul li a:hover {
      background: rgba(255,255,255,0.1);
      color: white;
      transform: translateY(-2px);
    }

    .admin-header nav ul li a.active {
      background: rgba(255,255,255,0.2);
      color: white;
    }

    /* Main Layout */
    .admin-main {
      display: flex;
      min-height: calc(100vh - 80px);
      gap: 0;
    }

    /* Sidebar */
    .sidebar {
      background: linear-gradient(180deg, #8aac7c 0%, #7a9c6c 100%);
      width: 300px;
      padding: 2rem;
      color: #1d1d1d;
      box-shadow: 4px 0 15px rgba(0,0,0,0.1);
      position: relative;
    }

    .sidebar h3 {
      color: #2d4a24;
      margin-bottom: 1rem;
      font-size: 1.3rem;
      padding: 1rem;
      background: rgba(255,255,255,0.15);
      border-radius: 12px;
      text-align: center;
      backdrop-filter: blur(10px);
    }

    .sidebar ul {
      list-style: none;
      margin-bottom: 2rem;
    }

    .sidebar ul li {
      margin-bottom: 0.5rem;
    }

    .sidebar ul li a {
      color: #1d1d1d;
      text-decoration: none;
      padding: 1rem;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      transition: all 0.3s ease;
      font-weight: 500;
      background: rgba(255,255,255,0.1);
    }

    .sidebar ul li a:hover,
    .sidebar ul li a.active {
      background: rgba(255,255,255,0.25);
      transform: translateX(5px);
      color: #2d4a24;
    }

    /* Filter Section */
    .filters {
      background: rgba(255,255,255,0.15);
      padding: 1.5rem;
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }

    .filters button {
      width: 100%;
      background: rgba(255,255,255,0.2);
      color: #2d4a24;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 0.8rem 1rem;
      border-radius: 10px;
      margin-bottom: 0.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      justify-content: flex-start;
    }

    .filters button:hover {
      background: rgba(255,255,255,0.4);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .filters button.active {
      background: rgba(255,255,255,0.5);
      color: #1a2f16;
      font-weight: 700;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      background: transparent;
      overflow-y: auto;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      background: white;
      padding: 1.5rem;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      flex-wrap: wrap;
      gap: 1rem;
    }

    .content-header h2 {
      color: #2d4a24;
      font-size: 2rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .content-header h2::before {
      content: 'üìã';
      font-size: 1.5rem;
    }

    /* Search and Controls */
    .search-controls {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 25px;
      padding: 0.5rem 1rem;
      transition: all 0.3s ease;
      min-width: 300px;
    }

    .search-bar:focus-within {
      border-color: #8aac7c;
      background: white;
      box-shadow: 0 0 0 3px rgba(138, 172, 124, 0.1);
    }

    .search-bar i {
      color: #8aac7c;
      margin-right: 0.5rem;
    }

    .search-bar input {
      border: none;
      outline: none;
      background: transparent;
      flex: 1;
      font-size: 1rem;
    }

    .btn-export {
      background: linear-gradient(135deg, #17a2b8, #138496);
      color: white;
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
    }

    .btn-export:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(23, 162, 184, 0.3);
    }

    /* Statistics Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: white;
      padding: 1.5rem;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, #8aac7c, #7a9c6c);
    }

    .stat-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: #2d4a24;
      margin-bottom: 0.25rem;
    }

    .stat-label {
      color: #666;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Appointments Table */
    .appointments-container {
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      overflow: hidden;
    }

    .table-header {
      background: linear-gradient(135deg, #8aac7c, #7a9c6c);
      color: white;
      padding: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-header h3 {
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .appointments-table {
      width: 100%;
      border-collapse: collapse;
    }

    .appointments-table th,
    .appointments-table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }

    .appointments-table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #2d4a24;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .appointments-table tbody tr {
      transition: all 0.3s ease;
    }

    .appointments-table tbody tr:hover {
      background: #f8f9fa;
      transform: scale(1.01);
    }

    /* Status Badges */
    .status-badge {
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .status-pending {
      background: linear-gradient(135deg, #fff3cd, #ffeaa7);
      color: #856404;
    }

    .status-approved {
      background: linear-gradient(135deg, #d4edda, #00b894);
      color: #155724;
    }

    .status-ongoing {
      background: linear-gradient(135deg, #cce5ff, #74b9ff);
      color: #004085;
    }

    .status-completed {
      background: linear-gradient(135deg, #d1ecf1, #17a2b8);
      color: #0c5460;
    }

    .status-cancelled {
      background: linear-gradient(135deg, #f8d7da, #e17055);
      color: #721c24;
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 0.5rem;
    }

    .btn-action {
      padding: 0.4rem 0.8rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.8rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .btn-view {
      background: linear-gradient(135deg, #17a2b8, #138496);
      color: white;
    }

    .btn-edit {
      background: linear-gradient(135deg, #ffc107, #e0a800);
      color: #212529;
    }

    .btn-delete {
      background: linear-gradient(135deg, #dc3545, #c82333);
      color: white;
    }

    .btn-action:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      padding: 1.5rem;
      background: #f8f9fa;
    }

    .pagination button {
      padding: 0.5rem 1rem;
      border: 2px solid #e0e0e0;
      background: white;
      color: #333;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .pagination button:hover {
      border-color: #8aac7c;
      background: #8aac7c;
      color: white;
    }

    .pagination button.active {
      background: linear-gradient(135deg, #8aac7c, #7a9c6c);
      color: white;
      border-color: #8aac7c;
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem;
      color: #666;
    }

    .empty-state i {
      font-size: 4rem;
      color: #8aac7c;
      margin-bottom: 1rem;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #2d4a24;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 2rem;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid #e9ecef;
    }

    .modal-header h3 {
      color: #2d4a24;
      font-size: 1.5rem;
    }

    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close:hover {
      color: #333;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .admin-main {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        padding: 1rem;
      }
      
      .content {
        padding: 1rem;
      }
      
      .content-header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .search-controls {
        justify-content: stretch;
      }
      
      .search-bar {
        min-width: auto;
        flex: 1;
      }
      
      .appointments-table {
        font-size: 0.8rem;
      }
      
      .appointments-table th,
      .appointments-table td {
        padding: 0.5rem;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Loading Animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 3rem;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #8aac7c;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .appointments-container,
    .stat-card {
      animation: fadeInUp 0.6s ease;
    }
  </style>
</head>
<body>
  <header class="admin-header">
    <h1>Admin Dashboard</h1>
    <nav>
      <ul>
        <li><a href="/admin"><i class="fas fa-home"></i> Home</a></li>
        <li><a href="/admin/appointments" class="active"><i class="fas fa-calendar-alt"></i> Appointments</a></li>
        <li><a href="/admin/bookings"><i class="fas fa-book"></i> Bookings</a></li>
        <li><a href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
      </ul>
    </nav>
  </header>

  <main class="admin-main">
    <aside class="sidebar">
      <h3><i class="fas fa-calendar-check"></i> Appointments</h3>
      <ul>
        <li><a href="/admin/appointments/create"><i class="fas fa-plus-circle"></i> Create Appointment</a></li>
        <li><a href="/admin/appointments/view" class="active"><i class="fas fa-list"></i> View Appointments</a></li>
      </ul>

      <h3><i class="fas fa-filter"></i> Filter by Status</h3>
      <div class="filters">
        <button onclick="filterStatus('all')" class="active" id="filter-all">
          <i class="fas fa-list"></i> All Appointments
        </button>
        <button onclick="filterStatus('pending')" id="filter-pending">
          <i class="fas fa-clock"></i> Pending
        </button>
        <button onclick="filterStatus('approved')" id="filter-approved">
          <i class="fas fa-check-circle"></i> Approved
        </button>
        <button onclick="filterStatus('ongoing')" id="filter-ongoing">
          <i class="fas fa-spinner"></i> Ongoing
        </button>
        <button onclick="filterStatus('completed')" id="filter-completed">
          <i class="fas fa-check-double"></i> Completed
        </button>
        <button onclick="filterStatus('cancelled')" id="filter-cancelled">
          <i class="fas fa-times-circle"></i> Cancelled
        </button>
      </div>
    </aside>

    <section class="content">
      <div class="content-header">
        <h2>All Appointments</h2>
        <div class="search-controls">
          <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Search appointments..." id="searchInput">
          </div>
          <button class="btn-export" onclick="exportAppointments()">
            <i class="fas fa-download"></i> Export
          </button>
        </div>
      </div>

      <!-- Statistics Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">üìä</div>
          <div class="stat-number" id="totalAppointments">0</div>
          <div class="stat-label">Total Appointments</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚è≥</div>
          <div class="stat-number" id="pendingCount">0</div>
          <div class="stat-label">Pending</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚úÖ</div>
          <div class="stat-number" id="approvedCount">0</div>
          <div class="stat-label">Approved</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üîÑ</div>
          <div class="stat-number" id="ongoingCount">0</div>
          <div class="stat-label">Ongoing</div>
        </div>
      </div>

      <!-- Appointments Table -->
      <div class="appointments-container">
        <div class="table-header">
          <h3><i class="fas fa-calendar-alt"></i> Appointments List</h3>
          <span id="appointmentCount">Loading...</span>
        </div>

        <div id="loadingState" class="loading">
          <div class="spinner"></div>
        </div>

        <div id="appointmentsTableContainer" style="display: none;">
          <table class="appointments-table">
            <thead>
              <tr>
                <th><i class="fas fa-hashtag"></i> ID</th>
                <th><i class="fas fa-user"></i> Client Name</th>
                <th><i class="fas fa-calendar"></i> Date</th>
                <th><i class="fas fa-clock"></i> Time</th>
                <th><i class="fas fa-cog"></i> Service</th>
                <th><i class="fas fa-info-circle"></i> Status</th>
                <th><i class="fas fa-tools"></i> Actions</th>
              </tr>
            </thead>
            <tbody id="appointmentsTableBody">
              <!-- Appointments will be populated here -->
            </tbody>
          </table>
        </div>

        <div id="emptyState" class="empty-state" style="display: none;">
          <i class="fas fa-calendar-times"></i>
          <h3>No Appointments Found</h3>
          <p>No appointments match your current filter criteria.</p>
        </div>

        <div class="pagination" id="paginationContainer" style="display: none;">
          <button onclick="changePage('prev')" id="prevBtn">
            <i class="fas fa-chevron-left"></i> Previous
          </button>
          <span id="pageInfo">Page 1 of 1</span>
          <button onclick="changePage('next')" id="nextBtn">
            Next <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Appointment Details Modal -->
  <div id="appointmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-info-circle"></i> Appointment Details</h3>
        <span class="close" onclick="closeModal()">&times;</span>
      </div>
      <div id="appointmentDetails">
        <!-- Details will be populated here -->
      </div>
    </div>
  </div>

  <script>
    class AppointmentManager {
      constructor() {
        this.appointments = [];
        this.filteredAppointments = [];
        this.currentFilter = 'all';
        this.currentPage = 1;
        this.itemsPerPage = 10;
        this.searchTerm = '';
        
        this.initializeData();
        this.bindEvents();
      }

      initializeData() {
        // Simulate loading appointments data
        setTimeout(() => {
          this.appointments = this.generateSampleData();
          this.filteredAppointments = [...this.appointments];
          this.updateDisplay();
          this.updateStatistics();
          document.getElementById('loadingState').style.display = 'none';
          document.getElementById('appointmentsTableContainer').style.display = 'block';
          document.getElementById('paginationContainer').style.display = 'flex';
        }, 1500);
      }

      generateSampleData() {
        const statuses = ['pending', 'approved', 'ongoing', 'completed', 'cancelled'];
        const services = ['burial', 'columbarium', 'consultation', 'memorial', 'maintenance'];
        const names = [
          'John Smith', 'Maria Garcia', 'Robert Johnson', 'Emily Davis',
          'Michael Brown', 'Sarah Wilson', 'David Miller', 'Lisa Anderson',
          'James Taylor', 'Jennifer Martinez', 'William Jones', 'Patricia Thomas'
        ];

        return Array.from({ length: 45 }, (_, i) => ({
          id: `APT-${String(i + 1).padStart(3, '0')}`,
          clientName: names[Math.floor(Math.random() * names.length)],
          date: this.getRandomDate(),
          time: this.getRandomTime(),
          service: services[Math.floor(Math.random() * services.length)],
          status: statuses[Math.floor(Math.random() * statuses.length)],
          notes: `Additional notes for appointment ${i + 1}`,
          createdAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000),
          phone: `(555) ${String(Math.floor(Math.random() * 900) + 100)}-${String(Math.floor(Math.random() * 9000) + 1000)}`,
          email: `client${i + 1}@example.com`
        }));
      }

      getRandomDate() {
        const start = new Date();
        const end = new Date();
        end.setDate(end.getDate() + 60);
        return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()))
          .toISOString().split('T')[0];
      }

      getRandomTime() {
        const hours = Math.floor(Math.random() * 8) + 9; // 9 AM to 5 PM
        const minutes = Math.random() < 0.5 ? '00' : '30';
        return `${String(hours).padStart(2, '0')}:${minutes}`;
      }

      bindEvents() {
        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
          this.searchTerm = e.target.value.toLowerCase();
          this.applyFilters();
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
          const modal = document.getElementById('appointmentModal');
          if (e.target === modal) {
            this.closeModal();
          }
        });
      }

      filterStatus(status) {
        this.currentFilter = status;
        this.currentPage = 1;
        
        // Update active filter button
        document.querySelectorAll('.filters button').forEach(btn => {
          btn.classList.remove('active');
        });
        document.getElementById(`filter-${status}`).classList.add('active');
        
        this.applyFilters();
        this.showNotification(`Filtered by: ${status === 'all' ? 'All Appointments' : status}`, 'info');
      }

      applyFilters() {
        let filtered = [...this.appointments];

        // Apply status filter
        if (this.currentFilter !== 'all') {
          filtered = filtered.filter(apt => apt.status === this.currentFilter);
        }

        // Apply search filter
        if (this.searchTerm) {
          filtered = filtered.filter(apt => 
            apt.clientName.toLowerCase().includes(this.searchTerm) ||
            apt.id.toLowerCase().includes(this.searchTerm) ||
            apt.service.toLowerCase().includes(this.searchTerm)
          );
        }

        this.filteredAppointments = filtered;
        this.updateDisplay();
      }

      updateDisplay() {
        const tbody = document.getElementById('appointmentsTableBody');
        const startIndex = (this.currentPage - 1) * this.itemsPerPage;
        const endIndex = startIndex + this.itemsPerPage;
        const pageAppointments = this.filteredAppointments.slice(startIndex, endIndex);

        if (pageAppointments.length === 0) {
          document.getElementById('appointmentsTableContainer').style.display = 'none';
          document.getElementById('emptyState').style.display = 'block';
          document.getElementById('paginationContainer').style.display = 'none';
          return;
        }

        document.getElementById('appointmentsTableContainer').style.display = 'block';
        document.getElementById('emptyState').style.display = 'none';
        document.getElementById('paginationContainer').style.display = 'flex';

        tbody.innerHTML = pageAppointments.map(apt => `
          <tr>
            <td><strong>${apt.id}</strong></td>
            <td>
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-user-circle" style="color: #8aac7c;"></i>
                ${apt.clientName}
              </div>
            </td>
            <td>
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-calendar" style="color: #8aac7c;"></i>
                ${new Date(apt.date).toLocaleDateString()}
              </div>
            </td>
            <td>
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-clock" style="color: #8aac7c;"></i>
                ${apt.time}
              </div>
            </td>
            <td>
              <span style="text-transform: capitalize; font-weight: 600;">
                ${this.getServiceIcon(apt.service)} ${apt.service}
              </span>
            </td>
            <td>
              <span class="status-badge status-${apt.status}">
                ${this.getStatusIcon(apt.status)} ${apt.status}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-view" onclick="appointmentManager.viewAppointment('${apt.id}')">
                  <i class="fas fa-eye"></i> View
                </button>
                <button class="btn-action btn-edit" onclick="appointmentManager.editAppointment('${apt.id}')">
                  <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn-action btn-delete" onclick="appointmentManager.deleteAppointment('${apt.id}')">
                  <i class="fas fa-trash"></i> Delete
                </button>
              </div>
            </td>
          </tr>
        `).join('');

        this.updatePagination();
        document.getElementById('appointmentCount').textContent = 
          `Showing ${startIndex + 1}-${Math.min(endIndex, this.filteredAppointments.length)} of ${this.filteredAppointments.length}`;
      }

      getServiceIcon(service) {
        const icons = {
          burial: 'üèõÔ∏è',
          columbarium: 'üè∫',
          consultation: 'üí¨',
          memorial: 'üåπ',
          maintenance: 'üîß'
        };
        return icons[service] || 'üìã';
      }

      getStatusIcon(status) {
        const icons = {
          pending: '‚è≥',
          approved: '‚úÖ',
          ongoing: 'üîÑ',
          completed: '‚úÖ',
          cancelled: '‚ùå'
        };
        return icons[status] || 'üìã';
      }

      updatePagination() {
        const totalPages = Math.ceil(this.filteredAppointments.length / this.itemsPerPage);
        document.getElementById('pageInfo').textContent = `Page ${this.currentPage} of ${totalPages}`;
        
        document.getElementById('prevBtn').disabled = this.currentPage === 1;
        document.getElementById('nextBtn').disabled = this.currentPage === totalPages;
      }

      updateStatistics() {
        const stats = {
          total: this.appointments.length,
          pending: this.appointments.filter(apt => apt.status === 'pending').length,
          approved: this.appointments.filter(apt => apt.status === 'approved').length,
          ongoing: this.appointments.filter(apt => apt.status === 'ongoing').length
        };

        // Animate numbers
        this.animateNumber('totalAppointments', stats.total);
        this.animateNumber('pendingCount', stats.pending);
        this.animateNumber('approvedCount', stats.approved);
        this.animateNumber('ongoingCount', stats.ongoing);
      }

      animateNumber(elementId, target) {
        const element = document.getElementById(elementId);
        let current = 0;
        const increment = target / 30;
        const timer = setInterval(() => {
          current += increment;
          if (current >= target) {
            current = target;
            clearInterval(timer);
          }
          element.textContent = Math.floor(current);
        }, 50);
      }

      changePage(direction) {
        const totalPages = Math.ceil(this.filteredAppointments.length / this.itemsPerPage);
        
        if (direction === 'prev' && this.currentPage > 1) {
          this.currentPage--;
        } else if (direction === 'next' && this.currentPage < totalPages) {
          this.currentPage++;
        }
        
        this.updateDisplay();
      }

      viewAppointment(id) {
        const appointment = this.appointments.find(apt => apt.id === id);
        if (!appointment) return;

        const detailsHtml = `
          <div style="display: grid; gap: 1rem;">
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
              <div>
                <strong>Appointment ID:</strong><br>
                <span style="color: #8aac7c; font-weight: 600;">${appointment.id}</span>
              </div>
              <div>
                <strong>Status:</strong><br>
                <span class="status-badge status-${appointment.status}">
                  ${this.getStatusIcon(appointment.status)} ${appointment.status}
                </span>
              </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
              <div>
                <strong>Client Name:</strong><br>
                <span>${appointment.clientName}</span>
              </div>
              <div>
                <strong>Phone:</strong><br>
                <span>${appointment.phone}</span>
              </div>
            </div>
            
            <div>
              <strong>Email:</strong><br>
              <span>${appointment.email}</span>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
              <div>
                <strong>Date:</strong><br>
                <span>${new Date(appointment.date).toLocaleDateString()}</span>
              </div>
              <div>
                <strong>Time:</strong><br>
                <span>${appointment.time}</span>
              </div>
            </div>
            
            <div>
              <strong>Service Type:</strong><br>
              <span style="text-transform: capitalize;">${this.getServiceIcon(appointment.service)} ${appointment.service}</span>
            </div>
            
            <div>
              <strong>Notes:</strong><br>
              <span>${appointment.notes}</span>
            </div>
            
            <div>
              <strong>Created:</strong><br>
              <span>${appointment.createdAt.toLocaleDateString()} at ${appointment.createdAt.toLocaleTimeString()}</span>
            </div>
          </div>
        `;

        document.getElementById('appointmentDetails').innerHTML = detailsHtml;
        document.getElementById('appointmentModal').style.display = 'block';
      }

      editAppointment(id) {
        this.showNotification(`Edit functionality for appointment ${id} - Coming soon!`, 'info');
      }

      deleteAppointment(id) {
        if (confirm(`Are you sure you want to delete appointment ${id}?`)) {
          this.appointments = this.appointments.filter(apt => apt.id !== id);
          this.applyFilters();
          this.updateStatistics();
          this.showNotification(`Appointment ${id} deleted successfully!`, 'success');
        }
      }

      closeModal() {
        document.getElementById('appointmentModal').style.display = 'none';
      }

      exportAppointments() {
        this.showNotification('Exporting appointments to CSV...', 'info');
        
        // Simulate export
        setTimeout(() => {
          this.showNotification('Appointments exported successfully!', 'success');
        }, 2000);
      }

      showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
          ${message}
        `;
        
        Object.assign(notification.style, {
          position: 'fixed',
          top: '100px',
          right: '20px',
          padding: '1rem 1.5rem',
          borderRadius: '10px',
          color: 'white',
          fontWeight: '600',
          zIndex: '9999',
          animation: 'slideInRight 0.3s ease',
          background: type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8',
          maxWidth: '350px',
          wordWrap: 'break-word',
          boxShadow: '0 4px 20px rgba(0,0,0,0.2)'
        });
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOutRight 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 4000);
      }
    }

    // Global functions for onclick handlers
    let appointmentManager;

    function filterStatus(status) {
      appointmentManager.filterStatus(status);
    }

    function changePage(direction) {
      appointmentManager.changePage(direction);
    }

    function exportAppointments() {
      appointmentManager.exportAppointments();
    }

    function closeModal() {
      appointmentManager.closeModal();
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      appointmentManager = new AppointmentManager();
    });

    // Add CSS animations for notifications
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOutRight {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>