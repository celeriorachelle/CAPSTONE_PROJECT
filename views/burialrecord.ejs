  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Burial Records | Everlasting Peace Memorial Park</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/stylesheets/admin.css" />

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"/>
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css"/>
  <link rel="stylesheet" href="/stylesheets/burialrecord.css" />
</head>

<body>
  <!-- Reusable topbar -->
  <%- include('partials/admin/topbar', { activePage: 'burialRecord' }) %>
  <script>
    // alias legacy hamburger id to new sidebarToggle so older scripts keep working
    document.addEventListener('DOMContentLoaded', () => {
      const hb = document.getElementById('hamburger-btn');
      const st = document.getElementById('sidebarToggle');
      if (hb && st && !hb.dataset.mapped) {
        hb.addEventListener('click', () => st.click());
        hb.dataset.mapped = 'true';
      }
    });
  </script>

  <main class="admin-main">
    <!-- Sidebar -->
    <%- include('partials/admin/sidebar', { activePage: 'burialRecord' }) %>

    <!-- Content Section -->
    <section class="content">
      <header class="topbar">
        <div class="topbar-left">
          <h2>Burial Records</h2>
          <div class="date-time" id="currentDateTime"></div>
        </div>
      </header>

      <!-- Table Section -->
      <section class="records-table">
        <h3><i class="fas fa-table"></i> Burial Records Table</h3>
        <div class="table-container">
          <table id="burialTable">
      <thead>
  <tr>
    <th>Plot No.</th>
    <th>Deceased Name</th>
    <th>Birth Date</th>
    <th>Death Date</th>
    <th>Location</th>
    <th>Plot Type</th>
    <th>Booked By</th>
   
  </tr>
</thead>
<tbody>
  <% if (burialRecords && burialRecords.length > 0) { %>
    <% burialRecords.forEach(record => { %>
      <tr>
        <td><%= record.plot_number %></td>
        <td><%= record.deceased_firstName %> <%= record.deceased_lastName %></td>
        <td><%= record.birth_date || 'N/A' %></td>
        <td><%= record.death_date || 'N/A' %></td>
        <td><%= record.location %></td>
        <td><%= record.item_name || record.plot_type %></td>
        <td><%= record.booked_by || 'N/A' %></td>
        
      </tr>
    <% }) %>
  <% } else { %>
    <tr>
      <td colspan="8">No burial records available</td>
    </tr>
  <% } %>
</tbody>
          </table>
        </div>
      </section>
    </section>
  </main>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

  <script>
    // Live date/time
    function updateDateTime() {
      const now = new Date();
      document.getElementById("currentDateTime").textContent = now.toLocaleString();
    }
    updateDateTime();
    setInterval(updateDateTime, 1000);

    // Initialize DataTable with search and export
    $(document).ready(function() {
      $('#burialTable').DataTable({
        dom: 'Bfrtip',
        pageLength: 10,
        buttons: [
          'copy', 'csv', 'excel', 'print'
        ]
      });
    });
  </script>
</body>
</html>
